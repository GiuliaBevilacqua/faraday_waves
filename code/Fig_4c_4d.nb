(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49594,       1340]
NotebookOptionsPosition[     48128,       1314]
NotebookOutlinePosition[     48484,       1330]
CellTagsIndexPosition[     48441,       1327]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.770029639768697*^9, 3.770029640266136*^9}, {
  3.770973937372691*^9, 3.770973938016862*^9}, {3.7709745394471207`*^9, 
  3.770974542450688*^9}, {3.789126459013335*^9, 3.789126460234612*^9}},
 CellLabel->
  "In[849]:=",ExpressionUUID->"dc9286de-9865-4189-aaca-dc926e0f274b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KK3x3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k1arm", "[", 
        RowBox[{"-", "1"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "*", 
        RowBox[{"k1arm", "[", "0", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"k1arm", "[", "1", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KK5x5", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k1arm", "[", 
        RowBox[{"-", "2"}], "]"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"k1arm", "[", 
        RowBox[{"-", "1"}], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"2", "*", 
        RowBox[{"k1arm", "[", "0", "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"k1arm", "[", "1", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"k1arm", "[", "2", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB3x3", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"k3arm", "[", 
        RowBox[{"-", "1"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k2arm", "[", "0", "]"}], ",", "0", ",", 
       RowBox[{"k3arm", "[", "0", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"k2arm", "[", "1", "]"}], ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB5x5", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"k3arm", "[", 
        RowBox[{"-", "2"}], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k2arm", "[", 
        RowBox[{"-", "1"}], "]"}], ",", "0", ",", 
       RowBox[{"k3arm", "[", 
        RowBox[{"-", "1"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"k2arm", "[", "0", "]"}], ",", "0", ",", 
       RowBox[{"k3arm", "[", "0", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"k2arm", "[", "1", "]"}], ",", "0", ",", 
       RowBox[{"k3arm", "[", "0", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"k2arm", "[", "2", "]"}], ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3x3", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "KK3x3", "]"}], ".", "BB3x3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M5x5", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "KK5x5", "]"}], ".", "BB5x5"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.770025953475169*^9, 3.770026119597405*^9}, {
   3.770026155119631*^9, 3.770026164678112*^9}, {3.770973318148507*^9, 
   3.770973344104389*^9}, 3.770973415453123*^9, {3.781334632869196*^9, 
   3.781334864522688*^9}, {3.78133490191488*^9, 3.7813349022742653`*^9}},
 CellLabel->
  "In[850]:=",ExpressionUUID->"9d5ba325-9330-48aa-bba7-2be1c78058b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k1arm", "[", "n_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", "\[Mu]", " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"H", " ", 
      RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}]}], 
    SuperscriptBox["k", "2"]], "-", 
   RowBox[{"\[ImaginaryI]", " ", "k", " ", "\[Gamma]", " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"H", " ", 
      RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
    RowBox[{"Garm", "[", "n", "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "g", " ", "\[Rho]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}]}], "k"], 
   "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", "k"}], "]"}], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}], 
    SuperscriptBox["k", "3"]], "-", 
   FractionBox[
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Mu]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}], "k"], 
   "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}], 
    SuperscriptBox["k", "3"]], "+", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Mu]", " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"H", " ", "k"}], "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", "k"}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}]}], 
    SuperscriptBox["k", "2"]], "+", 
   RowBox[{"\[ImaginaryI]", " ", "k", " ", "\[Gamma]", " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"H", " ", "k"}], "]"}], " ", 
    RowBox[{"Garm", "[", "n", "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "g", " ", "\[Rho]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", "k"}], "]"}], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}]}], "k"], 
   "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Mu]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"qarm", "[", "n", "]"}], "2"]}], 
    SuperscriptBox["k", "2"]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Mu]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"qarm", "[", "n", "]"}], "2"]}], 
    SuperscriptBox["k", "3"]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", "k"}], "]"}]}], 
    SuperscriptBox["k", "3"]], "+", 
   RowBox[{"\[ImaginaryI]", " ", "k", " ", "\[Gamma]", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"H", " ", "k"}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "g", " ", "\[Rho]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", "k"}], "]"}]}], "k"], "+", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Mu]", " ", 
    RowBox[{"Garm", "[", "n", "]"}], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"H", " ", "k"}], "]"}]}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", "k"}], "]"}]}], 
    SuperscriptBox["k", "2"]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["k", "2"], " ", "\[Gamma]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], 
    RowBox[{"qarm", "[", "n", "]"}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "g", " ", "\[Rho]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], 
    RowBox[{"qarm", "[", "n", "]"}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "k", " ", "\[Gamma]", " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], 
    RowBox[{"qarm", "[", "n", "]"}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "g", " ", "\[Rho]", " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], 
    RowBox[{"k", " ", 
     RowBox[{"qarm", "[", "n", "]"}]}]], "-", 
   FractionBox[
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Mu]", " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
     RowBox[{"qarm", "[", "n", "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], "k"], "+", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["k", "3"]], 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["n", "2"], " ", "\[Rho]", " ", 
     SuperscriptBox["\[Omega]", "2"], " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
     RowBox[{"qarm", "[", "n", "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Mu]", " ", 
     RowBox[{"Garm", "[", "n", "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"qarm", "[", "n", "]"}], "3"], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], 
    SuperscriptBox["k", "3"]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k3arm", "[", "n_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"H", " ", 
        RowBox[{"qarm", "[", 
         RowBox[{"1", "+", "n"}], "]"}]}], "]"}], " ", 
      RowBox[{"Garm", "[", 
       RowBox[{"1", "+", "n"}], "]"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "+", "n"}], "\[Equal]", "0"}], ",", "0", ",", "1"}], 
       "]"}]}], "k"]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", "k"}], "]"}], " ", 
     RowBox[{"Garm", "[", 
      RowBox[{"1", "+", "n"}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "+", "n"}], "\[Equal]", "0"}], ",", "H", ",", "1"}], 
      "]"}]}], "k"], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "+", "n"}], "\[Equal]", "0"}], ",", "H", ",", "1"}], 
      "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", "k"}], "]"}]}], "k"], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "+", "n"}], "\[Equal]", "0"}], ",", "0", ",", "1"}], 
      "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", 
        RowBox[{"1", "+", "n"}], "]"}]}], "]"}]}], 
    RowBox[{"qarm", "[", 
     RowBox[{"1", "+", "n"}], "]"}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"Garm", "[", 
      RowBox[{"1", "+", "n"}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "+", "n"}], "\[Equal]", "0"}], ",", "1", ",", "0"}], 
      "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", 
        RowBox[{"1", "+", "n"}], "]"}]}], "]"}]}], 
    RowBox[{"k", " ", 
     RowBox[{"qarm", "[", 
      RowBox[{"1", "+", "n"}], "]"}]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k2arm", "[", "n_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", "k"], 
     RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"H", " ", 
        RowBox[{"qarm", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "]"}], " ", 
      RowBox[{"Garm", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], "]"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], "\[Equal]", "0"}], ",", "0", ",", 
        "1"}], "]"}]}]}]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"Cosh", "[", 
      RowBox[{"H", " ", "k"}], "]"}], " ", 
     RowBox[{"Garm", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "\[Equal]", "0"}], ",", "H", ",", 
       "1"}], "]"}]}], "k"], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "\[Equal]", "0"}], ",", "H", ",", 
       "1"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", "k"}], "]"}]}], "k"], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "\[Equal]", "0"}], ",", "0", ",", 
       "1"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "]"}]}], 
    RowBox[{"qarm", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], "]"}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "\[Rho]", " ", 
     RowBox[{"Garm", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], "]"}], " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "\[Equal]", "0"}], ",", "1", ",", 
       "0"}], "]"}], " ", 
     RowBox[{"Sinh", "[", 
      RowBox[{"H", " ", 
       RowBox[{"qarm", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "]"}]}], 
    RowBox[{"k", " ", 
     RowBox[{"qarm", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], "]"}]}]]}]}]}], "Input",
 CellChangeTimes->{{3.770026432858453*^9, 3.770026479094287*^9}, {
  3.7709733628491592`*^9, 3.770973375430835*^9}},
 CellLabel->
  "In[856]:=",ExpressionUUID->"3b692a49-e7e8-4d16-800e-7877bef78b67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Garm", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"k", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"H", " ", "k"}], "]"}], " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"qarm", "[", "n", "]"}]}], "-", 
       RowBox[{"2", " ", "k", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}], " ", 
        RowBox[{"qarm", "[", "n", "]"}], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"H", " ", "k"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"H", " ", 
          RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"qarm", "[", "n", "]"}], "2"], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"H", " ", 
          RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["k", "2"]}], " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"H", " ", 
        RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
      RowBox[{"qarm", "[", "n", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"Cosh", "[", 
       RowBox[{"H", " ", "k"}], "]"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "H", ",", "1"}], "]"}], " ", 
      RowBox[{"qarm", "[", "n", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cosh", "[", 
       RowBox[{"H", " ", 
        RowBox[{"qarm", "[", "n", "]"}]}], "]"}], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "0", ",", "1"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"qarm", "[", "n", "]"}], "3"]}], "+", 
     RowBox[{"2", " ", "k", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
      RowBox[{"qarm", "[", "n", "]"}], " ", 
      RowBox[{"Sinh", "[", 
       RowBox[{"H", " ", "k"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["k", "2"], " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
      RowBox[{"Sinh", "[", 
       RowBox[{"H", " ", 
        RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"qarm", "[", "n", "]"}], "2"], " ", 
      RowBox[{"Sinh", "[", 
       RowBox[{"H", " ", 
        RowBox[{"qarm", "[", "n", "]"}]}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.7700274544019833`*^9, 3.770973384290432*^9},
 CellLabel->
  "In[689]:=",ExpressionUUID->"3ccdc686-db5a-4940-8c65-56380305e55a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"qarm", "[", "0", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "H"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"k", "^", "2"}], " ", 
      RowBox[{"H", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qarm", "[", 
    RowBox[{"-", "1"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "H"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "^", "2"}], " ", 
       RowBox[{"H", "^", "2"}]}], "-", 
      RowBox[{"\[Alpha]\[Omega]", "^", "2"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qarm", "[", "1", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "H"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "^", "2"}], " ", 
       RowBox[{"H", "^", "2"}]}], "-", 
      RowBox[{"\[Alpha]\[Omega]", "^", "2"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qarm", "[", 
    RowBox[{"-", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "H"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "^", "2"}], " ", 
       RowBox[{"H", "^", "2"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"\[Alpha]\[Omega]", "^", "2"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qarm", "[", "2", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "H"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "^", "2"}], " ", 
       RowBox[{"H", "^", "2"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"\[Alpha]\[Omega]", "^", "2"}]}]}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.770027147118701*^9, 3.770027220657729*^9}, 
   3.77002734797197*^9, 3.77097339716459*^9, {3.7813354686814013`*^9, 
   3.78133547404382*^9}, {3.781335512471916*^9, 3.781335514731967*^9}},
 CellLabel->
  "In[690]:=",ExpressionUUID->"74768758-b65d-434d-b294-25bca0f30673"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]x", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"\[Mu]", "/", "\[Rho]"}], "]"}], "  ", 
    RowBox[{"(", 
     RowBox[{"\[Alpha]\[Omega]", "/", "H"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", " ", "=", " ", 
   RowBox[{"\[Mu]", " ", "H", " ", "\[Alpha]\[Gamma]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Rho]", " ", "g", " ", "H"}], ")"}], "/", "\[Alpha]g"}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[695]:=",ExpressionUUID->"b3eea01a-409a-4c7a-b66b-a2e877c747c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KK3x3a", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", "KK3x3", "]"}], "/.", 
     RowBox[{"k", "\[Rule]", " ", 
      RowBox[{"kk", "/", "H"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KK5x5a", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", "KK5x5", "]"}], "/.", 
     RowBox[{"k", "\[Rule]", " ", 
      RowBox[{"kk", "/", "H"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB3x3a", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", "BB3x3", "]"}], "/.", 
     RowBox[{"k", "\[Rule]", " ", 
      RowBox[{"kk", "/", "H"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB5x5a", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", "BB5x5", "]"}], "/.", 
     RowBox[{"k", "\[Rule]", " ", 
      RowBox[{"kk", "/", "H"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.770027387243732*^9, 3.770027431408771*^9}, {
  3.770027472708132*^9, 3.7700274770682364`*^9}, {3.7813349430186443`*^9, 
  3.781334988982543*^9}, {3.781335523071501*^9, 3.781335534104916*^9}, {
  3.7813356096291103`*^9, 3.7813356139115143`*^9}},
 CellLabel->
  "In[699]:=",ExpressionUUID->"1804b8e8-a1f3-4036-96ac-24ec73149050"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M3x3a", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"g", "*", 
     RowBox[{
      RowBox[{"Inverse", "[", "KK3x3a", "]"}], ".", "BB3x3a"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.770027378898005*^9, 3.770027406284699*^9}, {
   3.7700274841898527`*^9, 3.770027519982341*^9}, {3.770027668190774*^9, 
   3.770027703608305*^9}, {3.770973473367303*^9, 3.770973513018427*^9}, {
   3.781334992484021*^9, 3.7813350324358*^9}, 3.7813356160924597`*^9, 
   3.7831689214486837`*^9, {3.78331863616219*^9, 3.783318673698752*^9}, {
   3.80742588314824*^9, 
   3.807425883427812*^9}},ExpressionUUID->"9589fcde-92cc-421e-952a-\
bc1e8b702a34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"limite\[Alpha]\[Gamma]3x3", "  ", "=", " ", 
   RowBox[{"Limit", "[", 
    RowBox[{"M3x3a", ",", 
     RowBox[{"\[Alpha]\[Gamma]", "\[Rule]", " ", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"limite\[Alpha]\[Gamma]5x5", "  ", "=", " ", 
   RowBox[{"Limit", "[", 
    RowBox[{"M5x5a", ",", 
     RowBox[{"\[Alpha]\[Gamma]", "\[Rule]", " ", "0"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.781335089909801*^9, 3.781335113742094*^9}},
 CellLabel->
  "In[716]:=",ExpressionUUID->"a6dc823b-55e6-4842-8fdc-f87607641ceb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upval", " ", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"div", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]\[Gamma]val", " ", "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]gval", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]\[Omega]val", " ", "=", "\[InvisibleSpace] ", "1.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "<", "upval"}], ",", 
    RowBox[{
     RowBox[{"i", "+=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bb", "=", 
      RowBox[{"(", 
       RowBox[{"1", "*", 
        RowBox[{"i", "/", "div"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state3x3", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"r", "=", "1"}], ",", 
       RowBox[{"r", "<", "3"}], ",", 
       RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"t", "=", "1"}], ",", 
         RowBox[{"t", "<", "3"}], ",", 
         RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Chop", "[", 
               RowBox[{"(", 
                RowBox[{"limite\[Alpha]\[Gamma]3x3", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Alpha]\[Omega]", "\[Rule]", " ", 
                    RowBox[{"N", "[", "\[Alpha]\[Omega]val", "]"}]}], ",", 
                   RowBox[{"kk", "\[Rule]", 
                    RowBox[{"N", "[", " ", "bb", "]"}]}], ",", 
                   RowBox[{"\[Alpha]g", "\[Rule]", " ", 
                    RowBox[{"N", "[", "\[Alpha]gval", "]"}]}]}], "}"}]}], 
                ")"}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "t"}], "]"}], "]"}], "===", "Indeterminate"}],
            ",", 
           RowBox[{"state3x3", "=", "True"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state5x5", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"r", "=", "1"}], ",", 
       RowBox[{"r", "<", "3"}], ",", 
       RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"t", "=", "1"}], ",", 
         RowBox[{"t", "<", "3"}], ",", 
         RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Chop", "[", 
               RowBox[{"(", 
                RowBox[{"limite\[Alpha]\[Gamma]5x5", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Alpha]\[Omega]", "\[Rule]", " ", 
                    RowBox[{"N", "[", "\[Alpha]\[Omega]val", "]"}]}], ",", 
                   RowBox[{"kk", "\[Rule]", 
                    RowBox[{"N", "[", " ", "bb", "]"}]}], ",", 
                   RowBox[{"\[Alpha]g", "\[Rule]", " ", 
                    RowBox[{"N", "[", "\[Alpha]gval", "]"}]}]}], "}"}]}], 
                ")"}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "t"}], "]"}], "]"}], "===", "Indeterminate"}],
            ",", 
           RowBox[{"state5x5", "=", "True"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"state3x3", ",", 
       RowBox[{"eigen3x3", "=", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", "16", ")"}]}]}], ",", 
       RowBox[{"eigen3x3", " ", "=", "  ", 
        RowBox[{"N", "[", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"limite\[Alpha]\[Gamma]3x3", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Alpha]\[Omega]", "\[Rule]", " ", 
                RowBox[{"N", "[", "\[Alpha]\[Omega]val", "]"}]}], ",", 
               RowBox[{"kk", "\[Rule]", 
                RowBox[{"N", "[", " ", "bb", "]"}]}], ",", 
               RowBox[{"\[Alpha]g", "\[Rule]", " ", 
                RowBox[{"N", "[", "\[Alpha]gval", "]"}]}]}], "}"}]}], ")"}], 
           ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Direct\>\""}]}], "]"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"state5x5", ",", 
       RowBox[{"eigen5x5", "=", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", "16", ")"}]}]}], ",", 
       RowBox[{"eigen5x5", " ", "=", "  ", 
        RowBox[{"N", "[", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"limite\[Alpha]\[Gamma]5x5", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Alpha]\[Omega]", "\[Rule]", " ", 
                RowBox[{"N", "[", "\[Alpha]\[Omega]val", "]"}]}], ",", 
               RowBox[{"kk", "\[Rule]", 
                RowBox[{"N", "[", " ", "bb", "]"}]}], ",", 
               RowBox[{"\[Alpha]g", "\[Rule]", " ", 
                RowBox[{"N", "[", "\[Alpha]gval", "]"}]}]}], "}"}]}], ")"}], 
           ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Direct\>\""}]}], "]"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inveigen3x3", "[", "i", "]"}], " ", "=", 
      RowBox[{"1", "/", 
       RowBox[{"Max", "[", 
        RowBox[{"Re", "[", "eigen3x3", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inveigen5x5", "[", "i", "]"}], " ", "=", 
      RowBox[{"1", "/", 
       RowBox[{"Max", "[", 
        RowBox[{"Re", "[", "eigen5x5", "]"}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lista3x3", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "*", 
         RowBox[{"i", "/", "div"}]}], ")"}], ",", 
       RowBox[{"inveigen3x3", "[", "i", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "upval"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lista5x5", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "*", 
         RowBox[{"i", "/", "div"}]}], ")"}], ",", 
       RowBox[{"inveigen5x5", "[", "i", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "upval"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.781335067925428*^9, 3.7813350866342373`*^9}, {
  3.781335124471499*^9, 3.781335231911044*^9}, {3.781335392508808*^9, 
  3.781335410845873*^9}, {3.781335563350593*^9, 3.7813355714045267`*^9}, {
  3.7813356832270727`*^9, 3.78133568528554*^9}, {3.788877128467719*^9, 
  3.7888771496073437`*^9}},
 CellLabel->
  "In[718]:=",ExpressionUUID->"c11790cd-0990-4d8e-8222-6f7eb29c4fc1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vet3x3", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ll", " ", "=", " ", "0"}], ",", 
    RowBox[{"ll", "<", 
     RowBox[{"Length", "[", "lista3x3", "]"}]}], ",", 
    RowBox[{
     RowBox[{"ll", "+=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"vet3x3", ",", " ", 
       RowBox[{
        RowBox[{"lista3x3", "[", 
         RowBox[{"[", "ll", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ord3x3", "=", " ", 
   RowBox[{"Sort", "[", "vet3x3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ac3x3", " ", "=", " ", 
   RowBox[{"ord3x3", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "ac3x3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos3x3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"lista3x3", ",", "ac3x3"}], "]"}], "-", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ")"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"k3x3", "=", 
  RowBox[{"N", "[", 
   RowBox[{"Extract", "[", 
    RowBox[{"lista3x3", ",", "pos3x3"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7813352737435017`*^9, 3.781335308027854*^9}, {
  3.781335358186625*^9, 3.781335358488152*^9}, {3.781335701379251*^9, 
  3.781335703389332*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"f1c670ba-30eb-4f60-a57e-12743ce58e5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vet5x5", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ll", " ", "=", " ", "0"}], ",", 
    RowBox[{"ll", "<", 
     RowBox[{"Length", "[", "lista5x5", "]"}]}], ",", 
    RowBox[{
     RowBox[{"ll", "+=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"vet5x5", ",", " ", 
       RowBox[{
        RowBox[{"lista5x5", "[", 
         RowBox[{"[", "ll", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ord5x5", " ", "=", " ", 
   RowBox[{"Sort", "[", "vet5x5", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ac5x5", "=", " ", 
   RowBox[{"ord5x5", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "ac5x5", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos5x5", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"lista5x5", ",", "ac5x5"}], "]"}], "-", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ")"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"k5x5", "=", 
  RowBox[{"N", "[", 
   RowBox[{"Extract", "[", 
    RowBox[{"lista5x5", ",", "pos5x5"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.781335309594791*^9, 3.781335363113309*^9}, {
  3.78133572427774*^9, 3.7813357245409193`*^9}},
 CellLabel->
  "In[411]:=",ExpressionUUID->"851fce43-6275-4cca-a038-2811594f1964"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"\[Alpha]", "=", "0"}], ",", 
   RowBox[{"\[Alpha]", "<", 
    RowBox[{"622", "/", "100"}]}], ",", 
   RowBox[{
    RowBox[{"\[Alpha]", "+=", 
     RowBox[{"2", "/", "10"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<\[Alpha]g= \>\"", ",", " ", 
      RowBox[{"N", "[", "\[Alpha]", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Beta]", "+=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"nn", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"jj", "=", "0"}], ",", 
      RowBox[{"jj", "<", 
       RowBox[{"155", "/", "100"}]}], ",", 
      RowBox[{
       RowBox[{"jj", "+=", 
        RowBox[{"1", "/", "100"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "+=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Alpha]\[Omega]= \>\"", ",", 
         RowBox[{"N", "[", "jj", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"upval", " ", "=", "250"}], ";", "\[IndentingNewLine]", 
       RowBox[{"div", " ", "=", " ", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]\[Gamma]val", " ", "=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nn", " ", "=", " ", 
        RowBox[{"N", "[", "jj", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "upval"}], ",", 
         RowBox[{
          RowBox[{"i", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"bb", "=", 
           RowBox[{"(", 
            RowBox[{"1", "*", 
             RowBox[{"i", "/", "div"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"stateARM", "=", "False"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"r", "=", "1"}], ",", 
            RowBox[{"r", "<", "3"}], ",", 
            RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"t", "=", "1"}], ",", 
              RowBox[{"t", "<", "3"}], ",", 
              RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Chop", "[", 
                    RowBox[{"(", 
                    RowBox[{"ARMMadim", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Alpha]\[Omega]", "\[Rule]", "nn"}], ",", 
                    RowBox[{"kk", "\[Rule]", " ", 
                    RowBox[{"N", "[", "bb", "]"}]}], ",", 
                    RowBox[{"\[Alpha]\[Gamma]", "\[Rule]", 
                    RowBox[{"N", "[", "\[Alpha]\[Gamma]val", "]"}]}], ",", 
                    RowBox[{"\[Alpha]g", "\[Rule]", 
                    RowBox[{"N", "[", " ", "\[Alpha]", "]"}]}]}], "}"}]}], 
                    ")"}], "]"}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"r", ",", "t"}], "]"}], "]"}], "===", 
                 "Indeterminate"}], ",", 
                RowBox[{"stateARM", "=", "True"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"stateARM", ",", 
            RowBox[{"eigenARM", "=", " ", 
             RowBox[{"10", "^", 
              RowBox[{"(", "16", ")"}]}]}], ",", 
            RowBox[{"eigenARM", " ", "=", "  ", 
             RowBox[{"N", "[", 
              RowBox[{"Eigenvalues", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ARMMadim", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Alpha]\[Omega]", "\[Rule]", "nn"}], ",", 
                    RowBox[{"kk", "\[Rule]", " ", 
                    RowBox[{"N", "[", "bb", "]"}]}], ",", 
                    RowBox[{"\[Alpha]\[Gamma]", "\[Rule]", 
                    RowBox[{"N", "[", "\[Alpha]\[Gamma]val", "]"}]}], ",", 
                    RowBox[{"\[Alpha]g", "\[Rule]", 
                    RowBox[{"N", "[", "\[Alpha]", "]"}]}]}], "}"}]}], ")"}], 
                ",", 
                RowBox[{"Method", "\[Rule]", "\"\<Direct\>\""}]}], "]"}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"inveigenARM", "[", "i", "]"}], " ", "=", 
           RowBox[{"1", "/", 
            RowBox[{"Max", "[", 
             RowBox[{"Re", "[", "eigenARM", " ", "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"stato", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"listaARM", "[", "p", "]"}], " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "*", 
              RowBox[{"i", "/", "div"}]}], ")"}], ",", 
            RowBox[{"inveigenARM", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "upval"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vet", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ll", " ", "=", " ", "0"}], ",", 
         RowBox[{"ll", "<", 
          RowBox[{"Length", "[", 
           RowBox[{"listaARM", "[", "p", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"ll", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"vet", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"listaARM", "[", "p", "]"}], "[", 
              RowBox[{"[", "ll", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ord", " ", "=", " ", 
        RowBox[{"Sort", "[", "vet", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"N", "[", 
         RowBox[{"ord", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ord", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "16"}], ")"}]}]}], ",", 
         RowBox[{"stato", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{"stato", ",", 
         RowBox[{
          RowBox[{"acr", "[", "p", "]"}], " ", "=", " ", 
          RowBox[{"ord", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"acr", "[", "p", "]"}], " ", "=", " ", 
          RowBox[{"ord", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Position", "[", " ", 
            RowBox[{
             RowBox[{"listaARM", "[", "p", "]"}], ",", 
             RowBox[{"acr", "[", "p", "]"}]}], "]"}], "-", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ")"}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"kcr", "[", "p", "]"}], "=", 
        RowBox[{"N", "[", 
         RowBox[{"Extract", "[", " ", 
          RowBox[{
           RowBox[{"listaARM", "[", "p", "]"}], ",", "pos"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<k= \>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{"kcr", "[", "p", "]"}], "]"}], ",", " ", "\"\< a= \>\"", 
         ",", " ", 
         RowBox[{"PowerExpand", "[", 
          RowBox[{"acr", "[", "p", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]\[Omega]ad", "[", "p", "]"}], "=", "jj"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listaac", "[", "\[Beta]", "]"}], "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]\[Omega]ad", "[", "jj", "]"}], ",", 
         RowBox[{"acr", "[", "jj", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", "1", ",", "p"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listakc", "[", "\[Beta]", "]"}], " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]\[Omega]ad", "[", "jj", "]"}], ",", 
         RowBox[{"kcr", "[", "jj", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", "1", ",", "p"}], "}"}]}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graficoa", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"listaac", "[", "\[Alpha]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "1", ",", "\[Beta]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graficok", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"listakc", "[", "\[Alpha]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "1", ",", "\[Beta]"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.77097398732657*^9, 3.7709742300659*^9}, {
  3.770974374098785*^9, 3.7709743838625317`*^9}, {3.770974502658415*^9, 
  3.7709745052595253`*^9}, {3.770975105071143*^9, 3.770975118610703*^9}, {
  3.770975646324836*^9, 3.770975652712899*^9}, {3.77097589135638*^9, 
  3.770975917827547*^9}, {3.770978178710229*^9, 3.770978179405291*^9}, {
  3.770992665669083*^9, 3.7709926883272333`*^9}, {3.771045428507717*^9, 
  3.771045428866446*^9}, {3.7710530489663763`*^9, 3.771053065778997*^9}, {
  3.771931961596593*^9, 3.7719320377255497`*^9}, {3.771932094891325*^9, 
  3.7719320958546343`*^9}, {3.80742599809336*^9, 
  3.8074259984687033`*^9}},ExpressionUUID->"4ef35e72-fdb0-4809-a909-\
d3932230b445"]
},
Evaluator->"Local",
WindowSize->{1280, 710},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 368, 6, 30, "Input",ExpressionUUID->"dc9286de-9865-4189-aaca-dc926e0f274b"],
Cell[929, 28, 3450, 99, 136, "Input",ExpressionUUID->"9d5ba325-9330-48aa-bba7-2be1c78058b2"],
Cell[4382, 129, 13963, 395, 578, "Input",ExpressionUUID->"3b692a49-e7e8-4d16-800e-7877bef78b67"],
Cell[18348, 526, 3425, 95, 100, "Input",ExpressionUUID->"3ccdc686-db5a-4940-8c65-56380305e55a"],
Cell[21776, 623, 1999, 66, 115, "Input",ExpressionUUID->"74768758-b65d-434d-b294-25bca0f30673"],
Cell[23778, 691, 732, 22, 94, "Input",ExpressionUUID->"b3eea01a-409a-4c7a-b66b-a2e877c747c2"],
Cell[24513, 715, 1319, 34, 94, "Input",ExpressionUUID->"1804b8e8-a1f3-4036-96ac-24ec73149050"],
Cell[25835, 751, 688, 15, 30, "Input",ExpressionUUID->"9589fcde-92cc-421e-952a-bc1e8b702a34"],
Cell[26526, 768, 590, 15, 52, "Input",ExpressionUUID->"a6dc823b-55e6-4842-8fdc-f87607641ceb"],
Cell[27119, 785, 7263, 182, 577, "Input",ExpressionUUID->"c11790cd-0990-4d8e-8222-6f7eb29c4fc1"],
Cell[34385, 969, 1661, 46, 199, "Input",ExpressionUUID->"f1c670ba-30eb-4f60-a57e-12743ce58e5e"],
Cell[36049, 1017, 1611, 45, 199, "Input",ExpressionUUID->"851fce43-6275-4cca-a038-2811594f1964"],
Cell[37663, 1064, 10461, 248, 934, "Input",ExpressionUUID->"4ef35e72-fdb0-4809-a909-d3932230b445"]
}
]
*)

